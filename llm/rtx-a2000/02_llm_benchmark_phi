/gpu-benchmark/llm$ python llm_benchmark.py --models gpt2 microsoft/Phi-3-mini-4k-instruct
/home/hhau/code/repos/gpu-benchmark/llm/.venv/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
--------------------------------------------------
üöÄ Benchmarking Model: gpt2
--------------------------------------------------
Using device: CUDA (single GPU)
‚úÖ Model loaded in: 1.53 seconds

--- Benchmark Results ---
üìù Prompt: 'Hello, my name is'
üìú Generated Output (50 tokens): ' John. I'm a writer, and I'm a writer. I'm a writer. I'm a writer. I'm a writer. I'm a writer. I'm a writer. I'm a writer. I'm a writer. I'm...'

--- Performance ---
‚è±Ô∏è Total Generation Time: 0.84 s
‚ö° Tokens per Second (TPS): 59.17 tokens/s

--- Hardware Utilization ---
üß† Peak CPU Usage: 8.70%
üíæ Peak System RAM Usage: 1910.61 MB
üéÆ VRAM Used for Model: 767.53 MB
üìà Additional VRAM for Generation: 28.00 MB
üîù Peak VRAM Usage: 795.53 MB
--------------------------------------------------

--------------------------------------------------
üöÄ Benchmarking Model: microsoft/Phi-3-mini-4k-instruct
--------------------------------------------------
Using device: CUDA (single GPU)
Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:05<00:00,  2.68s/it]
‚úÖ Model loaded in: 34.59 seconds

--- Benchmark Results ---
üìù Prompt: 'Hello, my name is'
üìú Generated Output (50 tokens): ' John Smith. I'm interested in learning more about the history of the United States. Can you provide me with a brief overview? Certainly, John. The history of the United States is a rich tapestry that spans over...'

--- Performance ---
‚è±Ô∏è Total Generation Time: 55.19 s
‚ö° Tokens per Second (TPS): 0.91 tokens/s

--- Hardware Utilization ---
üß† Peak CPU Usage: 9.40%
üíæ Peak System RAM Usage: 1466.58 MB
üéÆ VRAM Used for Model: 8147.53 MB
üìà Additional VRAM for Generation: 22.00 MB
üîù Peak VRAM Usage: 8169.53 MB
--------------------------------------------------